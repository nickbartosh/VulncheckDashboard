{% extends "base.html" %}

{% block content %}
<div class="card" style="max-width: 600px; margin: 0 auto;">
    <h2 style="margin-bottom: 2rem;">Edit Asset</h2>
    
    <form method="POST">
        <div class="form-group">
            <label for="name">Asset Name *</label>
            <input type="text" id="name" name="name" value="{{ asset.name }}" required>
        </div>
        
        <div class="form-group">
            <label for="type">Asset Type *</label>
            <select id="type" name="type" required>
                <option value="Server" {% if asset.type == 'Server' %}selected{% endif %}>Server</option>
                <option value="Database" {% if asset.type == 'Database' %}selected{% endif %}>Database</option>
                <option value="Workstation" {% if asset.type == 'Workstation' %}selected{% endif %}>Workstation</option>
                <option value="Network Device" {% if asset.type == 'Network Device' %}selected{% endif %}>Network Device</option>
                <option value="Application" {% if asset.type == 'Application' %}selected{% endif %}>Application</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="ip_address">IP Address *</label>
            <input type="text" id="ip_address" name="ip_address" value="{{ asset.ip_address }}" required>
        </div>
        
        <div class="form-group">
            <label for="software">Software *</label>
            <input type="text" id="software" name="software" value="{{ asset.software }}" required>
        </div>
        
        <div class="form-group">
            <label for="version">Version *</label>
            <input type="text" id="version" name="version" value="{{ asset.version }}" required>
        </div>
        
        <div class="form-group">
            <label for="criticality">Criticality *</label>
            <select id="criticality" name="criticality" required>
                <option value="Critical" {% if asset.criticality == 'Critical' %}selected{% endif %}>Critical</option>
                <option value="High" {% if asset.criticality == 'High' %}selected{% endif %}>High</option>
                <option value="Medium" {% if asset.criticality == 'Medium' %}selected{% endif %}>Medium</option>
                <option value="Low" {% if asset.criticality == 'Low' %}selected{% endif %}>Low</option>
            </select>
        </div>
        
        <div style="display: flex; gap: 1rem;">
            <button type="submit" class="btn btn-primary">Update Asset</button>
            <a href="{{ url_for('inventory') }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}
"""

# vulnerabilities.html
"""
{% extends "base.html" %}

{% block content %}
<div class="header-actions">
    <h2>Vulnerability Intelligence</h2>
    <div>
        <select id="assetFilter" style="padding: 0.6rem; border-radius: 4px; border: 1px solid #ddd;">
            <option value="">All Assets</option>
            {% for asset in assets %}
            <option value="{{ asset.id }}">{{ asset.name }}</option>
            {% endfor %}
        </select>
    </div>
</div>

<table>
    <thead>
        <tr>
            <th>CVE ID</th>
            <th>Asset</th>
            <th>Severity</th>
            <th>CVSS Score</th>
            <th>Description</th>
            <th>Exploit Available</th>
            <th>Published</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody id="vulnTableBody">
        {% for vuln in vulnerabilities %}
        <tr data-asset-id="{{ vuln.asset_id }}">
            <td><strong>{{ vuln.cve_id }}</strong></td>
            <td>{{ vuln.asset_name }}</td>
            <td>
                <span class="badge badge-{{ vuln.severity.lower() }}">
                    {{ vuln.severity }}
                </span>
            </td>
            <td><strong>{{ vuln.cvss_score }}</strong></td>
            <td>{{ vuln.description[:100] }}{% if vuln.description|length > 100 %}...{% endif %}</td>
            <td>
                {% if vuln.exploit_available %}
                <span style="color: #e74c3c; font-weight: bold;">⚠️ Yes</span>
                {% else %}
                <span style="color: #27ae60;">No</span>
                {% endif %}
            </td>
            <td>{{ vuln.published_date }}</td>
            <td>
                <span class="badge" style="background: #e67e22;">{{ vuln.status }}</span>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<script>
    document.getElementById('assetFilter').addEventListener('change', function() {
        const assetId = this.value;
        const rows = document.querySelectorAll('#vulnTableBody tr');
        
        rows.forEach(row => {
            if (assetId === '' || row.dataset.assetId === assetId) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    });
</script>
{% endblock %}